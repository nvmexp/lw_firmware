/* _LWRM_COPYRIGHT_BEGIN_
 *
 * Copyright 2016-2021 by LWPU Corporation.  All rights reserved.  All
 * information contained herein is proprietary and confidential to LWPU
 * Corporation.  Any use, reproduction, or disclosure without the written
 * permission of LWPU Corporation is prohibited.
 *
 * _LWRM_COPYRIGHT_END_
 */

/*!
 * @file   sec2_prmpkgp10x.c
 * @brief  Contains all PlayReady MPK and certificate related routines specific
 *         to SEC2 GP10X.
 */

/* ------------------------- System Includes -------------------------------- */
#include "sec2sw.h"
#include "dev_sec_csb.h"
#include "dev_gc6_island.h"
#include "dev_gc6_island_addendum.h"
#include "scp_internals.h"

/* ------------------------- Application Includes --------------------------- */
#include "sec2_hs.h"
#include "sec2_objpr.h"
#include "pr/pr_common.h"
#include "pr/pr_mpk.h"
#include "lwosselwreovly.h"
#include "drmbuild_oem.h"
#include "oemteelprovcerttemplate.h"

#include "config/g_pr_private.h"

/* ------------------------- Types Definitions ------------------------------ */
/* ------------------------- External Definitions --------------------------- */
/* ------------------------- Function Prototypes ---------------------------- */
/* ------------------------- Global Variables ------------------------------- */
LwU32 g_mpke_sl150_debug[PR_MPK_SIZE_DWORD] GCC_ATTRIB_ALIGN(SCP_BUF_ALIGNMENT);
LwU32 g_mpke_sl150_prod[PR_MPK_SIZE_DWORD]  GCC_ATTRIB_ALIGN(SCP_BUF_ALIGNMENT);
LwU32 g_mpke_sl3000_prod[PR_MPK_SIZE_DWORD] GCC_ATTRIB_ALIGN(SCP_BUF_ALIGNMENT);
LwU32 g_mpkAlignedTmp[PR_MPK_SIZE_DWORD]    GCC_ATTRIB_ALIGN(SCP_BUF_ALIGNMENT);

/* ------------------------- Macros and Defines ----------------------------- */
/*
 * The following defines were callwlated with the "-x" flag of the bcertdump.exe
 * tool.  Use a complete device certificate chain created with the various cert
 * generation tools in the PK (including the generatedevicecert.exe tool to create
 * the full device cert chain.  The bcertdump.exe tool with the -x flag will
 * produce the following indexes from the leaf device certificate.  During local
 * provisioning these indexes will be used to update per device properties of the
 * certificate (including ECC public keys, certificate ID, client ID and the cert
 * digest).
 */
/* Below defines are used by SL150 boards */
#define OEM_TEE_LPROV_DEVICECERT_SIGNDATA_START_OFFSET_SL150             0x0014
#define OEM_TEE_LPROV_DEVICECERT_SIGNDATA_LENGTH_SL150                   0x01d8
#define OEM_TEE_LPROV_DEVICECERT_SIGNATURE_OFFSET_SL150                  0x01f8

#define OEM_TEE_LPROV_DEVICECERT_CERTID_OFFSET_SL150                     0x002c
#define OEM_TEE_LPROV_DEVICECERT_CLIENTID_OFFSET_SL150                   0x006c
#define OEM_TEE_LPROV_DEVICECERT_CERTDIGEST_OFFSET_SL150                 0x0048

#define OEM_TEE_LPROV_DEVICECERT_PUBKEY_SIGN_OFFSET_SL150                0x00c4
#define OEM_TEE_LPROV_DEVICECERT_PUBKEY_ENCRYPT_OFFSET_SL150             0x0114
#define OEM_TEE_LPROV_DEVICECERT_PUBKEY_PRND_ENCRYPT_OFFSET_SL150        0x0164

/* Below defines are used by SL3000 boards */
#define OEM_TEE_LPROV_DEVICECERT_SIGNDATA_START_OFFSET_SL3000_GP10X      0x0014
#define OEM_TEE_LPROV_DEVICECERT_SIGNDATA_LENGTH_SL3000_GP10X            0x0188
#define OEM_TEE_LPROV_DEVICECERT_SIGNATURE_OFFSET_SL3000_GP10X           0x01a8

#define OEM_TEE_LPROV_DEVICECERT_CERTID_OFFSET_SL3000_GP10X              0x002c
#define OEM_TEE_LPROV_DEVICECERT_CLIENTID_OFFSET_SL3000_GP10X            0x006c
#define OEM_TEE_LPROV_DEVICECERT_CERTDIGEST_OFFSET_SL3000_GP10X          0x0048

#define OEM_TEE_LPROV_DEVICECERT_PUBKEY_SIGN_OFFSET_SL3000_GP10X         0x00c8
#define OEM_TEE_LPROV_DEVICECERT_PUBKEY_ENCRYPT_OFFSET_SL3000_GP10X      0x0118
#define OEM_TEE_LPROV_DEVICECERT_PUBKEY_PRND_ENCRYPT_OFFSET_SL3000_GP10X 0x0000 /* This define is not applicable since Lwpu doesn't support PRND */

/* ------------------------- Static Variables ------------------------------- */
/*
<PlayReady_Cert_Chain>
    <Number_of_Certs>4</Number_of_Certs>
    <Certificate_1>
        <Basic_Data>
            <Cert_Type>Device</Cert_Type>
            <Selwrity_Level>150</Selwrity_Level>
            <Expiration>Not set</Expiration>
            <Device_Data>
                <Max_License_Size>10240</Max_License_Size>
                <Max_Header_Size>15360</Max_Header_Size>
                <Max_Lic_Chain_Depth>2</Max_Lic_Chain_Depth>
            </Device_Data>
            <Features>Transmitter,Receiver,Secure Clock,CRL Support,PlayReady3 Features</Features>
        </Basic_Data>
        <Key_Data>
            <KEY_0>
                <Key_Type>0x1</Key_Type>
                <Length>512 bit</Length>
                <Key_Value>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</Key_Value>
                <Key_Usage>Sign,</Key_Usage>
            </KEY_0>
            <KEY_1>
                <Key_Type>0x1</Key_Type>
                <Length>512 bit</Length>
                <Key_Value>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</Key_Value>
                <Key_Usage>Encrypt Key,</Key_Usage>
            </KEY_1>
            <KEY_2>
                <Key_Type>0x1</Key_Type>
                <Length>512 bit</Length>
                <Key_Value>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</Key_Value>
                <Key_Usage>PRND Encrypt,</Key_Usage>
            </KEY_2>
        </Key_Data>
        <Manufacturer>
            <Manufacturer>Contoso</Manufacturer>
            <Model_Name>Cool Device Name</Model_Name>
            <Model_Number>ABC-XYZ-123</Model_Number>
        </Manufacturer>
        <Signature>
            <Signature_Type>0x1</Signature_Type>
            <Issuer_Key_Length>512</Issuer_Key_Length>
            <Issuer_Key_Value>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</Issuer_Key_Value>
        </Signature>
    </Certificate_1>
    <Certificate_2>
        <Basic_Data>
            <Cert_Type>Issuer</Cert_Type>
            <Selwrity_Level>150</Selwrity_Level>
            <Expiration>Not set</Expiration>
            <Features>Transmitter,Receiver,Secure Clock,CRL Support,PlayReady3 Features</Features>
        </Basic_Data>
        <Key_Data>
            <KEY_0>
                <Key_Type>0x1</Key_Type>
                <Length>512 bit</Length>
                <Key_Value>UlT6XXcgAMzaVAJN9JLJVomCFwppjoqgMMcT748yX27D053iiEP69pjEBnTxWiSEVXj76/e2wDImTgQDtbLTVg==</Key_Value>
                <Key_Usage>Sign,Issuer-Device,Issuer-Link,</Key_Usage>
            </KEY_0>
        </Key_Data>
        <Manufacturer>
            <Manufacturer>Contoso</Manufacturer>
            <Model_Name>Cool Device Name</Model_Name>
            <Model_Number>ABC-XYZ-123</Model_Number>
        </Manufacturer>
        <Signature>
            <Signature_Type>0x1</Signature_Type>
            <Issuer_Key_Length>512</Issuer_Key_Length>
            <Issuer_Key_Value>I2Oibni7mnpq3JNZZr4jqi5FS6sEzMHg6+fcPkzm6kydSjQvLVA/ICbYjx39+2a0vG4+jPyBlsjzYM2/GtiaBA==</Issuer_Key_Value>
        </Signature>
    </Certificate_2>
    <Certificate_3>
        <Basic_Data>
            <Cert_Type>Issuer</Cert_Type>
            <Selwrity_Level>150</Selwrity_Level>
            <Expiration>Not set</Expiration>
            <Features>Empty</Features>
        </Basic_Data>
        <Key_Data>
            <KEY_0>
                <Key_Type>0x1</Key_Type>
                <Length>512 bit</Length>
                <Key_Value>I2Oibni7mnpq3JNZZr4jqi5FS6sEzMHg6+fcPkzm6kydSjQvLVA/ICbYjx39+2a0vG4+jPyBlsjzYM2/GtiaBA==</Key_Value>
                <Key_Usage>Sign,Issuer-Device,Issuer-Link,</Key_Usage>
            </KEY_0>
        </Key_Data>
        <Manufacturer>
            <Manufacturer>Contoso</Manufacturer>
            <Model_Name></Model_Name>
            <Model_Number></Model_Number>
        </Manufacturer>
        <Signature>
            <Signature_Type>0x1</Signature_Type>
            <Issuer_Key_Length>512</Issuer_Key_Length>
            <Issuer_Key_Value>HXg967obkuzhUWZqh0yKR2ZejRJJHhX7S0VVZfzr2G3UX61fHIZsrb93+n1jrZIYNQua35Fn8ayEY7T5A1aASw==</Issuer_Key_Value>
        </Signature>
    </Certificate_3>
    <Certificate_4>
        <Basic_Data>
            <Cert_Type>Issuer</Cert_Type>
            <Selwrity_Level>3000</Selwrity_Level>
            <Expiration>Not set</Expiration>
            <Features>Empty</Features>
        </Basic_Data>
        <Key_Data>
            <KEY_0>
                <Key_Type>0x1</Key_Type>
                <Length>512 bit</Length>
                <Key_Value>HXg967obkuzhUWZqh0yKR2ZejRJJHhX7S0VVZfzr2G3UX61fHIZsrb93+n1jrZIYNQua35Fn8ayEY7T5A1aASw==</Key_Value>
                <Key_Usage>Sign,Issuer-Device,Issuer-Link,</Key_Usage>
            </KEY_0>
        </Key_Data>
        <Manufacturer>
            <Manufacturer>Microsoft</Manufacturer>
            <Model_Name>PlayReady SL3000 Device Port + Link CA</Model_Name>
            <Model_Number>1.0.0.1</Model_Number>
        </Manufacturer>
        <Signature>
            <Signature_Type>0x1</Signature_Type>
            <Issuer_Key_Length>512</Issuer_Key_Length>
            <Issuer_Key_Value>hk1hz/IlbkIsVos8KAAc+z4VJ2WFhLoFIbebGCjZNt4dgmqPw+bn+nqQ1copRvH2Si77n13P/n5DTrRCk/rFqw==</Issuer_Key_Value>
        </Signature>
    </Certificate_4>
</PlayReady_Cert_Chain>
*/
/*
 * TODO (nkuo) - Consider renaming this file to sec2_prMpkAndCert for better readability
 */
static LwU8 s_rgbDeviceCertTemplate_SL150[] PR_ATTR_DATA_OVLY(_s_rgbDeviceCertTemplate_SL150) =
{
    0x43, 0x48, 0x41, 0x49, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x07, 0x84, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x04, 0x43, 0x45, 0x52, 0x54, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x02, 0x68,
    0x00, 0x00, 0x01, 0xd8, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x96,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x04,
    0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x02,
    0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x0d,
    0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0xfc, 0x00, 0x00, 0x00, 0x03, 0x00, 0x01, 0x02, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x02, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x01, 0x02, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00, 0x07,
    0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x43, 0x6f, 0x6e, 0x74,
    0x6f, 0x73, 0x6f, 0x00, 0x00, 0x00, 0x00, 0x14, 0x43, 0x6f, 0x6f, 0x6c, 0x20, 0x44, 0x65, 0x76,
    0x69, 0x63, 0x65, 0x20, 0x4e, 0x61, 0x6d, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c,
    0x41, 0x42, 0x43, 0x2d, 0x58, 0x59, 0x5a, 0x2d, 0x31, 0x32, 0x33, 0x00, 0x00, 0x01, 0x00, 0x08,
    0x00, 0x00, 0x00, 0x90, 0x00, 0x01, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x52, 0x54, 0xfa, 0x5d,
    0x77, 0x20, 0x00, 0xcc, 0xda, 0x54, 0x02, 0x4d, 0xf4, 0x92, 0xc9, 0x56, 0x89, 0x82, 0x17, 0x0a,
    0x69, 0x8e, 0x8a, 0xa0, 0x30, 0xc7, 0x13, 0xef, 0x8f, 0x32, 0x5f, 0x6e, 0xc3, 0xd3, 0x9d, 0xe2,
    0x88, 0x43, 0xfa, 0xf6, 0x98, 0xc4, 0x06, 0x74, 0xf1, 0x5a, 0x24, 0x84, 0x55, 0x78, 0xfb, 0xeb,
    0xf7, 0xb6, 0xc0, 0x32, 0x26, 0x4e, 0x04, 0x03, 0xb5, 0xb2, 0xd3, 0x56, 0x43, 0x45, 0x52, 0x54,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x01, 0xbc, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x01, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x58, 0x7b, 0xcb, 0xd1, 0xb8, 0x8c, 0x37, 0xcb, 0x2c, 0x74, 0xf9, 0xb1, 0x33,
    0x21, 0x5e, 0xe9, 0xee, 0x00, 0x00, 0x00, 0x96, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,
    0xae, 0x69, 0xf1, 0x4a, 0x5a, 0x6e, 0x87, 0xd5, 0x93, 0x95, 0x76, 0xba, 0x00, 0x22, 0xdc, 0x48,
    0x90, 0xe7, 0x3d, 0x5b, 0x68, 0x4b, 0x9f, 0xf6, 0x3f, 0x5c, 0x1a, 0xfe, 0x41, 0x20, 0xb3, 0x53,
    0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x05,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x09,
    0x00, 0x00, 0x00, 0x0d, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x52, 0x54, 0xfa, 0x5d, 0x77, 0x20, 0x00, 0xcc,
    0xda, 0x54, 0x02, 0x4d, 0xf4, 0x92, 0xc9, 0x56, 0x89, 0x82, 0x17, 0x0a, 0x69, 0x8e, 0x8a, 0xa0,
    0x30, 0xc7, 0x13, 0xef, 0x8f, 0x32, 0x5f, 0x6e, 0xc3, 0xd3, 0x9d, 0xe2, 0x88, 0x43, 0xfa, 0xf6,
    0x98, 0xc4, 0x06, 0x74, 0xf1, 0x5a, 0x24, 0x84, 0x55, 0x78, 0xfb, 0xeb, 0xf7, 0xb6, 0xc0, 0x32,
    0x26, 0x4e, 0x04, 0x03, 0xb5, 0xb2, 0xd3, 0x56, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x40,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x43, 0x6f, 0x6e, 0x74, 0x6f, 0x73, 0x6f, 0x00,
    0x00, 0x00, 0x00, 0x14, 0x43, 0x6f, 0x6f, 0x6c, 0x20, 0x44, 0x65, 0x76, 0x69, 0x63, 0x65, 0x20,
    0x4e, 0x61, 0x6d, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x41, 0x42, 0x43, 0x2d,
    0x58, 0x59, 0x5a, 0x2d, 0x31, 0x32, 0x33, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x90,
    0x00, 0x01, 0x00, 0x40, 0xa8, 0x45, 0x35, 0xe4, 0xb5, 0x51, 0x57, 0xd0, 0x81, 0xae, 0x0e, 0xe6,
    0x4c, 0x51, 0xb0, 0x87, 0xd1, 0xf3, 0x9d, 0xaf, 0x55, 0x30, 0xba, 0x45, 0x0f, 0x63, 0x5f, 0x41,
    0xb0, 0x5a, 0x7f, 0xe5, 0x08, 0x20, 0x0b, 0xa0, 0xd4, 0xbc, 0x85, 0x2f, 0xa6, 0x2c, 0x84, 0x6f,
    0x66, 0xff, 0x59, 0x31, 0x85, 0x33, 0x8e, 0x68, 0x8e, 0x73, 0x99, 0x32, 0x4d, 0x5d, 0xfb, 0x37,
    0x1c, 0x15, 0x18, 0xf7, 0x00, 0x00, 0x02, 0x00, 0x23, 0x63, 0xa2, 0x6e, 0x78, 0xbb, 0x9a, 0x7a,
    0x6a, 0xdc, 0x93, 0x59, 0x66, 0xbe, 0x23, 0xaa, 0x2e, 0x45, 0x4b, 0xab, 0x04, 0xcc, 0xc1, 0xe0,
    0xeb, 0xe7, 0xdc, 0x3e, 0x4c, 0xe6, 0xea, 0x4c, 0x9d, 0x4a, 0x34, 0x2f, 0x2d, 0x50, 0x3f, 0x20,
    0x26, 0xd8, 0x8f, 0x1d, 0xfd, 0xfb, 0x66, 0xb4, 0xbc, 0x6e, 0x3e, 0x8c, 0xfc, 0x81, 0x96, 0xc8,
    0xf3, 0x60, 0xcd, 0xbf, 0x1a, 0xd8, 0x9a, 0x04, 0x43, 0x45, 0x52, 0x54, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x01, 0x90, 0x00, 0x00, 0x01, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x58,
    0x25, 0xb3, 0x2a, 0xbd, 0xe6, 0x7a, 0xcf, 0x76, 0x96, 0x81, 0xb2, 0x72, 0x8a, 0x61, 0x7f, 0x6b,
    0x00, 0x00, 0x00, 0x96, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0xe4, 0x7d, 0xd8, 0x57,
    0x34, 0x7d, 0x12, 0x11, 0xd5, 0x9e, 0xcb, 0x1e, 0x38, 0x99, 0x8e, 0xfd, 0x90, 0xab, 0x5f, 0x5d,
    0x19, 0xf1, 0xb3, 0xb1, 0xf4, 0xf0, 0xe1, 0x28, 0xe8, 0x6b, 0xc5, 0xee, 0xff, 0xff, 0xff, 0xff,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x06,
    0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x23, 0x63, 0xa2, 0x6e, 0x78, 0xbb, 0x9a, 0x7a, 0x6a, 0xdc, 0x93, 0x59, 0x66, 0xbe, 0x23, 0xaa,
    0x2e, 0x45, 0x4b, 0xab, 0x04, 0xcc, 0xc1, 0xe0, 0xeb, 0xe7, 0xdc, 0x3e, 0x4c, 0xe6, 0xea, 0x4c,
    0x9d, 0x4a, 0x34, 0x2f, 0x2d, 0x50, 0x3f, 0x20, 0x26, 0xd8, 0x8f, 0x1d, 0xfd, 0xfb, 0x66, 0xb4,
    0xbc, 0x6e, 0x3e, 0x8c, 0xfc, 0x81, 0x96, 0xc8, 0xf3, 0x60, 0xcd, 0xbf, 0x1a, 0xd8, 0x9a, 0x04,
    0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x07,
    0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08,
    0x43, 0x6f, 0x6e, 0x74, 0x6f, 0x73, 0x6f, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x90,
    0x00, 0x01, 0x00, 0x40, 0x8d, 0x1b, 0xa9, 0x1e, 0xe2, 0x16, 0xff, 0xff, 0x40, 0x2d, 0xf1, 0x98,
    0x9e, 0x8b, 0xf9, 0x03, 0xd5, 0x57, 0x25, 0x3b, 0x64, 0x48, 0x6c, 0x49, 0xe4, 0x0f, 0x76, 0xcc,
    0xc1, 0x5f, 0xa1, 0xa9, 0xda, 0xef, 0x84, 0xa0, 0xbb, 0xc5, 0x12, 0xfb, 0xe1, 0x85, 0xe7, 0x48,
    0x4c, 0x59, 0xfe, 0x0f, 0xfa, 0x5c, 0x39, 0x2a, 0x3c, 0x3a, 0x4b, 0xb3, 0x04, 0x05, 0xf7, 0xce,
    0xcf, 0xa7, 0xec, 0xd4, 0x00, 0x00, 0x02, 0x00, 0x1d, 0x78, 0x3d, 0xeb, 0xba, 0x1b, 0x92, 0xec,
    0xe1, 0x51, 0x66, 0x6a, 0x87, 0x4c, 0x8a, 0x47, 0x66, 0x5e, 0x8d, 0x12, 0x49, 0x1e, 0x15, 0xfb,
    0x4b, 0x45, 0x55, 0x65, 0xfc, 0xeb, 0xd8, 0x6d, 0xd4, 0x5f, 0xad, 0x5f, 0x1c, 0x86, 0x6c, 0xad,
    0xbf, 0x77, 0xfa, 0x7d, 0x63, 0xad, 0x92, 0x18, 0x35, 0x0b, 0x9a, 0xdf, 0x91, 0x67, 0xf1, 0xac,
    0x84, 0x63, 0xb4, 0xf9, 0x03, 0x56, 0x80, 0x4b, 0x43, 0x45, 0x52, 0x54, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x01, 0xbc, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x58,
    0x88, 0x30, 0x30, 0x21, 0x45, 0xb4, 0x18, 0x76, 0x69, 0x25, 0x43, 0xbd, 0xd4, 0x04, 0x59, 0xb8,
    0x00, 0x00, 0x0b, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x6e, 0x4e, 0xd8, 0x38,
    0x94, 0x62, 0xa1, 0x28, 0x27, 0xce, 0x3a, 0x59, 0x80, 0xb6, 0xac, 0xa3, 0x06, 0x8b, 0xf7, 0xa2,
    0xc5, 0x20, 0x11, 0xc3, 0xc7, 0xa0, 0x74, 0xcf, 0xe2, 0x68, 0x0c, 0xf1, 0xff, 0xff, 0xff, 0xff,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x06,
    0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x1d, 0x78, 0x3d, 0xeb, 0xba, 0x1b, 0x92, 0xec, 0xe1, 0x51, 0x66, 0x6a, 0x87, 0x4c, 0x8a, 0x47,
    0x66, 0x5e, 0x8d, 0x12, 0x49, 0x1e, 0x15, 0xfb, 0x4b, 0x45, 0x55, 0x65, 0xfc, 0xeb, 0xd8, 0x6d,
    0xd4, 0x5f, 0xad, 0x5f, 0x1c, 0x86, 0x6c, 0xad, 0xbf, 0x77, 0xfa, 0x7d, 0x63, 0xad, 0x92, 0x18,
    0x35, 0x0b, 0x9a, 0xdf, 0x91, 0x67, 0xf1, 0xac, 0x84, 0x63, 0xb4, 0xf9, 0x03, 0x56, 0x80, 0x4b,
    0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x07,
    0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a,
    0x4d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x27,
    0x50, 0x6c, 0x61, 0x79, 0x52, 0x65, 0x61, 0x64, 0x79, 0x20, 0x53, 0x4c, 0x33, 0x30, 0x30, 0x30,
    0x20, 0x44, 0x65, 0x76, 0x69, 0x63, 0x65, 0x20, 0x50, 0x6f, 0x72, 0x74, 0x20, 0x2b, 0x20, 0x4c,
    0x69, 0x6e, 0x6b, 0x20, 0x43, 0x41, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x31, 0x2e, 0x30, 0x2e,
    0x30, 0x2e, 0x31, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x90, 0x00, 0x01, 0x00, 0x40,
    0x92, 0x97, 0xe8, 0x56, 0x66, 0xd2, 0x4c, 0xc0, 0x56, 0x1f, 0x6f, 0x93, 0x9e, 0x3b, 0x56, 0xc1,
    0x96, 0xa5, 0x37, 0x07, 0xda, 0x5d, 0x20, 0x36, 0x95, 0x6d, 0x2f, 0xc0, 0x80, 0x82, 0x04, 0x6b,
    0xc2, 0x21, 0x6f, 0xf6, 0x66, 0xb6, 0x02, 0x49, 0x88, 0xcb, 0xfa, 0x1f, 0xdb, 0x6b, 0x6b, 0x66,
    0xf8, 0x0b, 0xe1, 0x87, 0xf7, 0x58, 0x6f, 0xb9, 0x2e, 0x25, 0xa6, 0x36, 0xba, 0x68, 0x72, 0xcf,
    0x00, 0x00, 0x02, 0x00, 0x86, 0x4d, 0x61, 0xcf, 0xf2, 0x25, 0x6e, 0x42, 0x2c, 0x56, 0x8b, 0x3c,
    0x28, 0x00, 0x1c, 0xfb, 0x3e, 0x15, 0x27, 0x65, 0x85, 0x84, 0xba, 0x05, 0x21, 0xb7, 0x9b, 0x18,
    0x28, 0xd9, 0x36, 0xde, 0x1d, 0x82, 0x6a, 0x8f, 0xc3, 0xe6, 0xe7, 0xfa, 0x7a, 0x90, 0xd5, 0xca,
    0x29, 0x46, 0xf1, 0xf6, 0x4a, 0x2e, 0xfb, 0x9f, 0x5d, 0xcf, 0xfe, 0x7e, 0x43, 0x4e, 0xb4, 0x42,
    0x93, 0xfa, 0xc5, 0xab,
};

static LwU8 s_rgbDeviceCertTemplate_SL3000_GP10X[] PR_ATTR_DATA_OVLY(_s_rgbDeviceCertTemplate_SL3000_GP10X) =
{
    0x43, 0x48, 0x41, 0x49, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x07, 0x34, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x04, 0x43, 0x45, 0x52, 0x54, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x02, 0x18,
    0x00, 0x00, 0x01, 0x88, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x58, 0x3f, 0x83, 0xfc, 0x0c,
    0xa4, 0x14, 0x4d, 0xac, 0xa8, 0x25, 0xda, 0xc4, 0x4a, 0xae, 0x8b, 0x00, 0x00, 0x00, 0x0b, 0xb8,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x4b, 0xec, 0xde, 0x57, 0x15, 0x1d, 0xf1, 0xa6,
    0xb6, 0x44, 0x85, 0xf2, 0x4d, 0xce, 0xb8, 0xf1, 0xb4, 0x91, 0x1f, 0x26, 0xde, 0x46, 0xdc, 0x7d,
    0x3c, 0x9c, 0x5f, 0x0e, 0x06, 0x6a, 0x45, 0x8b, 0xff, 0xff, 0xff, 0xff, 0xfc, 0xb1, 0x62, 0x39,
    0x55, 0x0c, 0xeb, 0xa6, 0xe8, 0x6d, 0xc6, 0x67, 0x86, 0xc1, 0x6f, 0xac, 0x00, 0x01, 0x00, 0x04,
    0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x02,
    0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x10, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff,
    0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x09,
    0x00, 0x00, 0x00, 0x0d, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0xac, 0x00, 0x00, 0x00, 0x02,
    0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x37, 0x3d, 0x52, 0x66, 0xd6, 0x0c, 0xa7,
    0x9b, 0x3f, 0x9f, 0xe5, 0xf2, 0x4d, 0x08, 0x4d, 0x93, 0x26, 0x3a, 0x04, 0x58, 0xad, 0x48, 0x6f,
    0x66, 0xd3, 0x89, 0x8e, 0x3a, 0xa4, 0xd4, 0x6f, 0xf4, 0x7c, 0xff, 0x15, 0x39, 0x0d, 0x69, 0x2e,
    0xc9, 0x18, 0x6c, 0x43, 0xd2, 0x2e, 0x36, 0x43, 0x39, 0xa2, 0x8c, 0xed, 0x79, 0x08, 0xe8, 0x14,
    0xcb, 0xc8, 0x88, 0x79, 0x0b, 0x6c, 0x4a, 0x26, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0xee, 0x9c, 0x7b, 0x25, 0xce, 0x95, 0x66, 0x66,
    0xcd, 0x75, 0x16, 0x4f, 0x7e, 0xcb, 0xc7, 0xca, 0xd8, 0x64, 0x6f, 0xb3, 0xec, 0xd1, 0xbd, 0x94,
    0x58, 0xaa, 0xa8, 0x35, 0xd0, 0x04, 0xe3, 0xb6, 0x37, 0x94, 0x52, 0xd1, 0x19, 0x97, 0x39, 0x33,
    0x0c, 0x1a, 0xd8, 0x98, 0x6c, 0x8b, 0xab, 0xb1, 0x5d, 0x45, 0xec, 0xc2, 0x02, 0x42, 0x5a, 0x82,
    0x77, 0x71, 0x81, 0xaa, 0x39, 0xa1, 0x64, 0xce, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x02,
    0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x14,
    0x4e, 0x76, 0x69, 0x64, 0x69, 0x61, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69,
    0x6f, 0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x47, 0x50, 0x31, 0x30, 0x58, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x08, 0x47, 0x50, 0x31, 0x30, 0x58, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08,
    0x00, 0x00, 0x00, 0x90, 0x00, 0x01, 0x00, 0x40, 0x3d, 0xe4, 0x22, 0x4f, 0xd4, 0xdf, 0xa4, 0x01,
    0x31, 0xd5, 0x2c, 0x4b, 0x7b, 0x21, 0xef, 0xbd, 0xa8, 0x00, 0x2e, 0x44, 0x78, 0x22, 0x62, 0x8a,
    0x97, 0xda, 0x74, 0x0d, 0xdd, 0xaa, 0xdf, 0x05, 0x61, 0x8a, 0x98, 0x4e, 0x8b, 0xe0, 0x23, 0x8e,
    0xd9, 0x87, 0xbc, 0x53, 0x02, 0xf5, 0xa0, 0x4b, 0xae, 0x1a, 0x4b, 0xcb, 0x0d, 0x26, 0x8d, 0xea,
    0x65, 0x08, 0xd0, 0x1d, 0x49, 0xb6, 0x01, 0x38, 0x00, 0x00, 0x02, 0x00, 0x4b, 0x64, 0x43, 0xd5,
    0xf3, 0xae, 0x5b, 0x5f, 0x0f, 0x28, 0xfc, 0xe2, 0xad, 0x0e, 0x66, 0x54, 0x0c, 0x00, 0x82, 0x08,
    0xe7, 0x23, 0xde, 0x67, 0x8e, 0x0f, 0x41, 0x65, 0x71, 0x00, 0x35, 0x56, 0x8a, 0xbf, 0x79, 0x05,
    0x78, 0x5b, 0x81, 0x41, 0x37, 0x2a, 0xf9, 0x6f, 0x73, 0x6a, 0x31, 0x99, 0xaa, 0x35, 0x2d, 0xf9,
    0x05, 0x51, 0x8f, 0x02, 0x1d, 0x92, 0x8c, 0x62, 0xfe, 0xb1, 0x4c, 0xa0, 0x43, 0x45, 0x52, 0x54,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x01, 0xb8, 0x00, 0x00, 0x01, 0x28, 0x00, 0x01, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x58, 0x82, 0xe0, 0x2e, 0x28, 0x0a, 0xcc, 0x55, 0x4c, 0x96, 0x94, 0x13, 0x6e,
    0xe5, 0xc1, 0x68, 0xb8, 0x00, 0x00, 0x0b, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,
    0x54, 0xd0, 0xbd, 0x92, 0x7c, 0x08, 0x18, 0x13, 0x32, 0x99, 0xca, 0xc2, 0x61, 0xac, 0x96, 0x46,
    0x0d, 0x25, 0xc0, 0x2c, 0x7c, 0x97, 0xb1, 0x67, 0xd0, 0x1f, 0x81, 0x9a, 0x0e, 0x84, 0xf8, 0x29,
    0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x10, 0x01, 0x00, 0x00, 0x00,
    0xff, 0xff, 0xff, 0xff, 0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x02,
    0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x0d, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x60,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4b, 0x64, 0x43, 0xd5,
    0xf3, 0xae, 0x5b, 0x5f, 0x0f, 0x28, 0xfc, 0xe2, 0xad, 0x0e, 0x66, 0x54, 0x0c, 0x00, 0x82, 0x08,
    0xe7, 0x23, 0xde, 0x67, 0x8e, 0x0f, 0x41, 0x65, 0x71, 0x00, 0x35, 0x56, 0x8a, 0xbf, 0x79, 0x05,
    0x78, 0x5b, 0x81, 0x41, 0x37, 0x2a, 0xf9, 0x6f, 0x73, 0x6a, 0x31, 0x99, 0xaa, 0x35, 0x2d, 0xf9,
    0x05, 0x51, 0x8f, 0x02, 0x1d, 0x92, 0x8c, 0x62, 0xfe, 0xb1, 0x4c, 0xa0, 0x00, 0x00, 0x00, 0x02,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x3c,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x14, 0x4e, 0x76, 0x69, 0x64, 0x69, 0x61, 0x20, 0x43,
    0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08,
    0x47, 0x50, 0x31, 0x30, 0x58, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x47, 0x50, 0x31, 0x30,
    0x58, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x90, 0x00, 0x01, 0x00, 0x40,
    0x28, 0xdc, 0x51, 0xbe, 0xff, 0xff, 0x4f, 0xb1, 0xaf, 0xe4, 0x28, 0xae, 0x2e, 0xa5, 0xa7, 0x19,
    0xfa, 0xd9, 0x78, 0x12, 0x9c, 0x5d, 0x94, 0x2f, 0xbc, 0x1c, 0x3e, 0x35, 0xbd, 0xad, 0x37, 0xe4,
    0xb6, 0x65, 0x36, 0x4f, 0xf5, 0x46, 0xd7, 0x12, 0xc5, 0x3e, 0xbf, 0x1b, 0x45, 0x19, 0x4b, 0x83,
    0xbf, 0x96, 0x4b, 0x0a, 0x65, 0x15, 0xf7, 0x9e, 0xc1, 0xdb, 0xea, 0x1f, 0xd4, 0xe7, 0x5e, 0x44,
    0x00, 0x00, 0x02, 0x00, 0xdf, 0xd0, 0x3e, 0xa5, 0xa8, 0xf9, 0x12, 0x3c, 0xfd, 0xad, 0x77, 0x80,
    0x7a, 0xcd, 0xf1, 0x43, 0x1d, 0xfa, 0x7f, 0xfd, 0xd2, 0x2d, 0x3a, 0x69, 0xb9, 0xee, 0xcc, 0x9d,
    0xb8, 0x1b, 0xcf, 0x65, 0x3c, 0xdb, 0xc3, 0xbc, 0x0a, 0x11, 0x32, 0x76, 0xa1, 0xc3, 0xc5, 0x13,
    0x53, 0xfb, 0x4f, 0x34, 0xd0, 0x58, 0xff, 0xc0, 0x51, 0x4c, 0x42, 0xf9, 0x8b, 0xe5, 0x32, 0x24,
    0x5f, 0xc2, 0x77, 0x03, 0x43, 0x45, 0x52, 0x54, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x01, 0x94,
    0x00, 0x00, 0x01, 0x04, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x58, 0x96, 0xd5, 0xf8, 0x49,
    0x18, 0x51, 0x41, 0xe0, 0x24, 0x66, 0xd7, 0x3d, 0xb4, 0xa4, 0xb8, 0x21, 0x00, 0x00, 0x0b, 0xb8,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0xa4, 0x53, 0x8f, 0xe4, 0xb4, 0x53, 0x10, 0x43,
    0xac, 0x77, 0xf9, 0x27, 0x0d, 0x67, 0x0d, 0x9d, 0x65, 0x34, 0x8f, 0x0a, 0x0b, 0xcc, 0x54, 0x5d,
    0xf5, 0x9d, 0x1b, 0xc8, 0xac, 0x17, 0x99, 0x00, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x05,
    0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x64,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0xdf, 0xd0, 0x3e, 0xa5,
    0xa8, 0xf9, 0x12, 0x3c, 0xfd, 0xad, 0x77, 0x80, 0x7a, 0xcd, 0xf1, 0x43, 0x1d, 0xfa, 0x7f, 0xfd,
    0xd2, 0x2d, 0x3a, 0x69, 0xb9, 0xee, 0xcc, 0x9d, 0xb8, 0x1b, 0xcf, 0x65, 0x3c, 0xdb, 0xc3, 0xbc,
    0x0a, 0x11, 0x32, 0x76, 0xa1, 0xc3, 0xc5, 0x13, 0x53, 0xfb, 0x4f, 0x34, 0xd0, 0x58, 0xff, 0xc0,
    0x51, 0x4c, 0x42, 0xf9, 0x8b, 0xe5, 0x32, 0x24, 0x5f, 0xc2, 0x77, 0x03, 0x00, 0x00, 0x00, 0x03,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x07,
    0x00, 0x00, 0x00, 0x2c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x14, 0x4e, 0x76, 0x69, 0x64,
    0x69, 0x61, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x90,
    0x00, 0x01, 0x00, 0x40, 0x2f, 0x38, 0x21, 0xf2, 0x0f, 0x5f, 0xef, 0xcb, 0x11, 0x21, 0xac, 0xa6,
    0xbd, 0xa8, 0xe2, 0x52, 0x94, 0x74, 0x15, 0xff, 0x36, 0x55, 0xdd, 0xc1, 0x02, 0xde, 0xb2, 0x4b,
    0xa5, 0x46, 0xa6, 0x43, 0x58, 0x0d, 0x29, 0x79, 0xb3, 0xee, 0x2d, 0xf4, 0x66, 0x34, 0x29, 0xdf,
    0x54, 0xe0, 0x64, 0x23, 0x92, 0xfc, 0x07, 0x5e, 0xe2, 0x8a, 0x0c, 0xdd, 0xa6, 0x13, 0x0c, 0xcc,
    0x43, 0xa5, 0x12, 0xa5, 0x00, 0x00, 0x02, 0x00, 0x1d, 0x78, 0x3d, 0xeb, 0xba, 0x1b, 0x92, 0xec,
    0xe1, 0x51, 0x66, 0x6a, 0x87, 0x4c, 0x8a, 0x47, 0x66, 0x5e, 0x8d, 0x12, 0x49, 0x1e, 0x15, 0xfb,
    0x4b, 0x45, 0x55, 0x65, 0xfc, 0xeb, 0xd8, 0x6d, 0xd4, 0x5f, 0xad, 0x5f, 0x1c, 0x86, 0x6c, 0xad,
    0xbf, 0x77, 0xfa, 0x7d, 0x63, 0xad, 0x92, 0x18, 0x35, 0x0b, 0x9a, 0xdf, 0x91, 0x67, 0xf1, 0xac,
    0x84, 0x63, 0xb4, 0xf9, 0x03, 0x56, 0x80, 0x4b, 0x43, 0x45, 0x52, 0x54, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x01, 0xbc, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x58,
    0x88, 0x30, 0x30, 0x21, 0x45, 0xb4, 0x18, 0x76, 0x69, 0x25, 0x43, 0xbd, 0xd4, 0x04, 0x59, 0xb8,
    0x00, 0x00, 0x0b, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x6e, 0x4e, 0xd8, 0x38,
    0x94, 0x62, 0xa1, 0x28, 0x27, 0xce, 0x3a, 0x59, 0x80, 0xb6, 0xac, 0xa3, 0x06, 0x8b, 0xf7, 0xa2,
    0xc5, 0x20, 0x11, 0xc3, 0xc7, 0xa0, 0x74, 0xcf, 0xe2, 0x68, 0x0c, 0xf1, 0xff, 0xff, 0xff, 0xff,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x06,
    0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x1d, 0x78, 0x3d, 0xeb, 0xba, 0x1b, 0x92, 0xec, 0xe1, 0x51, 0x66, 0x6a, 0x87, 0x4c, 0x8a, 0x47,
    0x66, 0x5e, 0x8d, 0x12, 0x49, 0x1e, 0x15, 0xfb, 0x4b, 0x45, 0x55, 0x65, 0xfc, 0xeb, 0xd8, 0x6d,
    0xd4, 0x5f, 0xad, 0x5f, 0x1c, 0x86, 0x6c, 0xad, 0xbf, 0x77, 0xfa, 0x7d, 0x63, 0xad, 0x92, 0x18,
    0x35, 0x0b, 0x9a, 0xdf, 0x91, 0x67, 0xf1, 0xac, 0x84, 0x63, 0xb4, 0xf9, 0x03, 0x56, 0x80, 0x4b,
    0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x07,
    0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a,
    0x4d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x27,
    0x50, 0x6c, 0x61, 0x79, 0x52, 0x65, 0x61, 0x64, 0x79, 0x20, 0x53, 0x4c, 0x33, 0x30, 0x30, 0x30,
    0x20, 0x44, 0x65, 0x76, 0x69, 0x63, 0x65, 0x20, 0x50, 0x6f, 0x72, 0x74, 0x20, 0x2b, 0x20, 0x4c,
    0x69, 0x6e, 0x6b, 0x20, 0x43, 0x41, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x31, 0x2e, 0x30, 0x2e,
    0x30, 0x2e, 0x31, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x90, 0x00, 0x01, 0x00, 0x40,
    0x92, 0x97, 0xe8, 0x56, 0x66, 0xd2, 0x4c, 0xc0, 0x56, 0x1f, 0x6f, 0x93, 0x9e, 0x3b, 0x56, 0xc1,
    0x96, 0xa5, 0x37, 0x07, 0xda, 0x5d, 0x20, 0x36, 0x95, 0x6d, 0x2f, 0xc0, 0x80, 0x82, 0x04, 0x6b,
    0xc2, 0x21, 0x6f, 0xf6, 0x66, 0xb6, 0x02, 0x49, 0x88, 0xcb, 0xfa, 0x1f, 0xdb, 0x6b, 0x6b, 0x66,
    0xf8, 0x0b, 0xe1, 0x87, 0xf7, 0x58, 0x6f, 0xb9, 0x2e, 0x25, 0xa6, 0x36, 0xba, 0x68, 0x72, 0xcf,
    0x00, 0x00, 0x02, 0x00, 0x86, 0x4d, 0x61, 0xcf, 0xf2, 0x25, 0x6e, 0x42, 0x2c, 0x56, 0x8b, 0x3c,
    0x28, 0x00, 0x1c, 0xfb, 0x3e, 0x15, 0x27, 0x65, 0x85, 0x84, 0xba, 0x05, 0x21, 0xb7, 0x9b, 0x18,
    0x28, 0xd9, 0x36, 0xde, 0x1d, 0x82, 0x6a, 0x8f, 0xc3, 0xe6, 0xe7, 0xfa, 0x7a, 0x90, 0xd5, 0xca,
    0x29, 0x46, 0xf1, 0xf6, 0x4a, 0x2e, 0xfb, 0x9f, 0x5d, 0xcf, 0xfe, 0x7e, 0x43, 0x4e, 0xb4, 0x42,
    0x93, 0xfa, 0xc5, 0xab
};

/* ------------------------- Public Functions ------------------------------- */

/*!
 * @brief  Decrypt MPK
 */
FLCN_STATUS
prDecryptMpk_GP10X(LwU32 *pOut)
{
    LwU32        index           = 0;
    LwU32       *pSl             = NULL;
    LwU32        mpkVer[]        = {SEC2_LS_UCODE_VERSION, 0x0, 0x0, 0x0};
    FLCN_STATUS  status          = FLCN_OK;

    // Choosing right encrypted-key
    if (OS_SEC_FALC_IS_DBG_MODE())
    {
        pSl = g_mpke_sl150_debug;
    }
    else
    {
        // TODO: We may need to disable SL150 PROD for production scenarios
#ifndef PR_SL3000_ENABLED
        //
        // While MPK itself is same, the hw key for debug board is different from prod board.
        // So, MPK, when encrypted ends up with different value on debug board compared to prod board.
        //
        pSl = g_mpke_sl150_prod;
#else
        pSl = g_mpke_sl3000_prod;
#endif
    }

    // Ensure we are not running with revoked ACR, scrubber, UDE ucodes
    status = prCheckDependentBinMilwersion_HAL(&PrHal);
    if (status != FLCN_OK)
    {
        goto ErrExit;
    }

    /*
     *  Fkey = Enc(sig, PR_MPK_SECRET_KEY_INDEX)
     *  Dkey = Enc(Fkey, KDF(SALT, Ucodeversion | position))
     *  Key  = Dec(Ekey, Dkey)
     *    where Fkey = First key derived
     *          Dkey = Key used for decryption
     *          Key  = Actual MPK
     */
    for (index = 0; index < PR_MPK_SIZE_DWORD; index += 4)
    {
        mpkVer[2] = (index / 4);

        g_mpkAlignedTmp[0] = mpkVer[0] ^ PR_MPK_ENCRYPT_SALT_0;
        g_mpkAlignedTmp[1] = mpkVer[1] ^ PR_MPK_ENCRYPT_SALT_1;
        g_mpkAlignedTmp[2] = mpkVer[2] ^ PR_MPK_ENCRYPT_SALT_2;
        g_mpkAlignedTmp[3] = mpkVer[3] ^ PR_MPK_ENCRYPT_SALT_3;

        falc_scp_trap(TC_INFINITY);
        falc_scp_secret(PR_MPK_SECRET_KEY_INDEX, SCP_R1);
        falc_scp_encrypt_sig(SCP_R1, SCP_R2);
        falc_scp_key(SCP_R2);

        falc_trapped_dmwrite(falc_sethi_i((LwU32)g_mpkAlignedTmp, SCP_R1));
        falc_dmwait();

        falc_scp_encrypt(SCP_R1, SCP_R3);
        falc_scp_rkey10(SCP_R3, SCP_R2);
        falc_scp_key(SCP_R2);

        falc_trapped_dmwrite(falc_sethi_i((LwU32)&(pSl[index]), SCP_R1));
        falc_dmwait();

        falc_scp_decrypt(SCP_R1, SCP_R3);

        falc_trapped_dmread(falc_sethi_i((LwU32)g_mpkAlignedTmp, SCP_R3));
        falc_dmwait();
        falc_scp_trap(0);

        // Copying the key to output buffer
        pOut[index]   = g_mpkAlignedTmp[0];
        pOut[index+1] = g_mpkAlignedTmp[1];
        pOut[index+2] = g_mpkAlignedTmp[2];
        pOut[index+3] = g_mpkAlignedTmp[3];
    }

    // Clean up the variables used
    for (index = 0; index < PR_MPK_SIZE_DWORD; index++)
    {
        g_mpkAlignedTmp[index] = 0;
    }

    // Clean the SCP registers
    falc_scp_trap(TC_INFINITY);
    falc_scp_xor(SCP_R1, SCP_R1);
    falc_scp_xor(SCP_R2, SCP_R2);
    falc_scp_xor(SCP_R3, SCP_R3);
    falc_scp_xor(SCP_R4, SCP_R4);
    falc_scp_xor(SCP_R5, SCP_R5);
    falc_scp_xor(SCP_R6, SCP_R6);
    falc_scp_trap(0);

ErrExit:
    return status;
}

/*!
 * @brief  Retrieve the SL150 device cert template
 *
 * @param[in]  ppCert           The pointer points the buffer storing the address
 *                              of the cert template
 * @param[in]  pCertSize        The pointer points the buffer storing the size of
 *                              the cert template
 * @param[in]  pDevCertIndices  The pointer points the buffer storing the field
 *                              indices into the cert template
 */
void
prGetSL150DeviceCertTemplate_GP10X
(
    LwU8  **ppCert,
    LwU32  *pCertSize,
    void   *pDevCertIndices
)
{
    DRM_TEE_LPROV_CERT_INDEXES *pDTLCI = (DRM_TEE_LPROV_CERT_INDEXES *)pDevCertIndices;

    *ppCert    = s_rgbDeviceCertTemplate_SL150;
    *pCertSize = sizeof(s_rgbDeviceCertTemplate_SL150);

    pDTLCI->ibCertID                                             = OEM_TEE_LPROV_DEVICECERT_CERTID_OFFSET_SL150;
    pDTLCI->ibCertClientID                                       = OEM_TEE_LPROV_DEVICECERT_CLIENTID_OFFSET_SL150;
    pDTLCI->ibCertDigest                                         = OEM_TEE_LPROV_DEVICECERT_CERTDIGEST_OFFSET_SL150;
    pDTLCI->ibSignData                                           = OEM_TEE_LPROV_DEVICECERT_SIGNDATA_START_OFFSET_SL150;
    pDTLCI->cbSignData                                           = OEM_TEE_LPROV_DEVICECERT_SIGNDATA_LENGTH_SL150;
    pDTLCI->ibSignature                                          = OEM_TEE_LPROV_DEVICECERT_SIGNATURE_OFFSET_SL150;
    pDTLCI->rgibPubKeys[ DRM_TEE_LPROV_PUBKEY_SIGN_IDX ]         = OEM_TEE_LPROV_DEVICECERT_PUBKEY_SIGN_OFFSET_SL150;
    pDTLCI->rgibPubKeys[ DRM_TEE_LPROV_PUBKEY_ENCRYPT_IDX ]      = OEM_TEE_LPROV_DEVICECERT_PUBKEY_ENCRYPT_OFFSET_SL150;
#ifndef PR_V0404
    pDTLCI->rgibPubKeys[ DRM_TEE_LPROV_PUBKEY_PRND_ENCRYPT_IDX ] = OEM_TEE_LPROV_DEVICECERT_PUBKEY_PRND_ENCRYPT_OFFSET_SL150;
#endif
}

/*!
 * @brief  Retrieve the SL3000 device cert template
 *
 * @param[in]  ppCert           The pointer points the buffer storing the address
 *                              of the cert template
 * @param[in]  pCertSize        The pointer points the buffer storing the size of
 *                              the cert template
 * @param[in]  pDevCertIndices  The pointer points the buffer storing the field
 *                              indices into the cert template
 */
void
prGetSL3000DeviceCertTemplate_GP10X
(
    LwU8  **ppCert,
    LwU32  *pCertSize,
    void   *pDevCertIndices
)
{
    DRM_TEE_LPROV_CERT_INDEXES *pDTLCI = (DRM_TEE_LPROV_CERT_INDEXES *)pDevCertIndices;

    *ppCert    = s_rgbDeviceCertTemplate_SL3000_GP10X;
    *pCertSize = sizeof(s_rgbDeviceCertTemplate_SL3000_GP10X);

    pDTLCI->ibCertID                                             = OEM_TEE_LPROV_DEVICECERT_CERTID_OFFSET_SL3000_GP10X;
    pDTLCI->ibCertClientID                                       = OEM_TEE_LPROV_DEVICECERT_CLIENTID_OFFSET_SL3000_GP10X;
    pDTLCI->ibCertDigest                                         = OEM_TEE_LPROV_DEVICECERT_CERTDIGEST_OFFSET_SL3000_GP10X;
    pDTLCI->ibSignData                                           = OEM_TEE_LPROV_DEVICECERT_SIGNDATA_START_OFFSET_SL3000_GP10X;
    pDTLCI->cbSignData                                           = OEM_TEE_LPROV_DEVICECERT_SIGNDATA_LENGTH_SL3000_GP10X;
    pDTLCI->ibSignature                                          = OEM_TEE_LPROV_DEVICECERT_SIGNATURE_OFFSET_SL3000_GP10X;
    pDTLCI->rgibPubKeys[ DRM_TEE_LPROV_PUBKEY_SIGN_IDX ]         = OEM_TEE_LPROV_DEVICECERT_PUBKEY_SIGN_OFFSET_SL3000_GP10X;
    pDTLCI->rgibPubKeys[ DRM_TEE_LPROV_PUBKEY_ENCRYPT_IDX ]      = OEM_TEE_LPROV_DEVICECERT_PUBKEY_ENCRYPT_OFFSET_SL3000_GP10X;
#ifndef PR_V0404
    pDTLCI->rgibPubKeys[ DRM_TEE_LPROV_PUBKEY_PRND_ENCRYPT_IDX ] = OEM_TEE_LPROV_DEVICECERT_PUBKEY_PRND_ENCRYPT_OFFSET_SL3000_GP10X;
#endif
}

/*!
 * @brief  Ensure PR is not running with revoked ACR, scrubber, UDE ucodes
 *
 * @return FLCN_OK if there is no revoked ucode
 *         FLCN_ERR_HS_PR_MPK_DEC_NEEDS_NEWER_ACR_UDE_SCRUBBER if there is any revoked ucode
 *         Or bubble up the error code returned from the callee
 */
FLCN_STATUS
prCheckDependentBinMilwersion_GP10X(void)
{
    FLCN_STATUS  status;
    LwU32        lwrrAcrVer      = 0;
    LwU32        lwrrUdeVer      = 0;
    LwU32        lwrrScrubberVer = 0;
    LwU32        minAcrVer       = 0xFFFFFFFF;
    LwU32        minUdeVer       = 0xFFFFFFFF;
    LwU32        minScrubberVer  = 0xFFFFFFFF;
    LwU32        tmp;

    // Read the current versions of ACR, UDE and scrubber
    // XXX: Need to figure out a macro to collapse the following 3 lines into one
    status = BAR0_REG_RD32_HS_ERRCHK(LW_PGC6_BSI_SELWRE_SCRATCH_14, &tmp);
    if (status != FLCN_OK)
    {
        goto ErrExit;
    }
    lwrrAcrVer = DRF_VAL(_PGC6, _BSI_VPR_SELWRE_SCRATCH_14, _ACR_BINARY_VERSION, tmp);

    status = BAR0_REG_RD32_HS_ERRCHK(LW_PGC6_BSI_SELWRE_SCRATCH_15, &tmp);
    if (status != FLCN_OK)
    {
        goto ErrExit;
    }
    lwrrUdeVer      = DRF_VAL(_PGC6, _BSI_VPR_SELWRE_SCRATCH_15, _VBIOS_UDE_VERSION, tmp);
    lwrrScrubberVer = DRF_VAL(_PGC6, _BSI_VPR_SELWRE_SCRATCH_15, _SCRUBBER_BINARY_VERSION, tmp);

    status = BAR0_REG_RD32_HS_ERRCHK(LW_PMC_BOOT_42, &tmp);
    if (status != FLCN_OK)
    {
        goto ErrExit;
    }

    //
    // Compute the min required versions for ACR, UDE and scrubber
    //
    // For if/else below, the numbers have been obtained as follows
    // ACR: Adding one to the values found at https://rmopengrok.lwpu.com/source/xref/r370_00/uproc/acr/src/acr/pascal/acrucgp10x.c#acrGetFuseVersionSW_GP10X as of 10/13/2017
    // UDE: Looking up fuse.lwpu.com and picking the least value across all shipping SKUs for each chip. even if SW version was bumped after this, unless we can force update vbios in the field, we are stuck to lowest shipping value
    // Scrubber: Adding one to the values found at https://rmopengrok.lwpu.com/source/xref/r370_00/uproc/selwrescrub/src/pascal/selwrescrubgp104.c#selwrescrubRevokeHsBin_GP104 as of 10/13/2017
    //
    // Using if-else instead of switch-case due to concern raised by Sanket in https://lwcr.lwpu.com/sw/1935437/diffs/vs_base/769363/
    //
    // Question for team from Dhawal: Should we just drop UDE from the list to be err checked since we are not forcing any vbios update in the field?
    //
    // ##### GV100 TODO (nkuo) Need to update the min versions below before SL3000 signing
    tmp = DRF_VAL(_PMC, _BOOT_42, _CHIP_ID, tmp);
    if (tmp == LW_PMC_BOOT_42_CHIP_ID_GP102)
    {
        minAcrVer       = 4; // 5
        minUdeVer       = 1; // Sadly GP102-400-A1 has fuse value of 1 even though all others have value 0x2
        minScrubberVer  = 3; // 5
    }
    else if (tmp == LW_PMC_BOOT_42_CHIP_ID_GP104)
    {
        minAcrVer       = 4; // 5
        minUdeVer       = 4;
        minScrubberVer  = 4; // 5
    }
    else if (tmp == LW_PMC_BOOT_42_CHIP_ID_GP106)
    {
        minAcrVer       = 5; // 6
        minUdeVer       = 1; // Somewhat in same boat as GP102 but more than one SKU has 1
        minScrubberVer  = 3; // 5
    }
    else if (tmp == LW_PMC_BOOT_42_CHIP_ID_GP107)
    {
        minAcrVer       = 3; // 5
        minUdeVer       = 3;
        minScrubberVer  = 3; // 5
    }
    else if (tmp == LW_PMC_BOOT_42_CHIP_ID_GP108)
    {
        minAcrVer       = 2; // 3
        minUdeVer       = 3; // We don't know what will ship. But should be what's planned as of 12/29 for QS SKU shouldn't be any worse than what shipped for GP104/2/6.
        minScrubberVer  = 2; // 5
    }

    // Ensure that ACR, UDE and scrubber meet the min version criteria
    if ((lwrrAcrVer < minAcrVer) || (lwrrUdeVer < minUdeVer) || (lwrrScrubberVer < minScrubberVer))
    {
        status = FLCN_ERR_HS_PR_MPK_DEC_NEEDS_NEWER_ACR_UDE_SCRUBBER;
        goto ErrExit;
    }

ErrExit:
    return status;
}
